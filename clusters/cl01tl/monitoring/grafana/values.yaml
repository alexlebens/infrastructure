grafana:
  deploymentStrategy:
    type: Recreate
  createConfigmap: true
  serviceMonitor:
    enabled: true
  ingress:
    enabled: true
    ingressClassName: tailscale
    hosts:
      - grafana-cl01tl
    tls:
      - secretName: grafana-cl01tl
        hosts:
          - grafana-cl01tl
  persistence:
    enabled: true
    storageClassName: ceph-block
  admin:
    existingSecret: grafana-auth-secret
    userKey: admin-user
    passwordKey: admin-password
  envFromSecret: grafana-oauth-secret
  plugins:
    - grafana-clock-panel
    - grafana-worldmap-panel
    - grafana-treemap-panel
    - grafana-lokiexplore-app
    - isovalent-hubble-datasource
    - camptocamp-prometheus-alertmanager-datasource
  datasources:
    datasources.yaml:
      apiVersion: 1
      datasources:
        - name: Prometheus
          type: prometheus
          uid: prometheus
          url: http://kube-prometheus-stack-prometheus.kube-prometheus-stack:9090/
          access: proxy
          isDefault: true
          jsonData:
            timeInterval: 30s
        - name: Loki
          type: loki
          url: http://loki.loki:3100
          jsonData:
            httpHeaderName1: "X-Scope-OrgID"
          secureJsonData:
            httpHeaderValue1: "1"
  dashboardProviders:
    dashboardproviders.yaml:
      apiVersion: 1
      providers:
        - name: "app-gitea"
          orgId: 1
          folder: "Application"
          type: file
          disableDeletion: true
          editable: false
          options:
            path: /var/lib/grafana/dashboards/app-gitea
        - name: "srv-gitea"
          orgId: 1
          folder: "Service"
          type: file
          disableDeletion: true
          editable: false
          options:
            path: /var/lib/grafana/dashboards/srv-gitea
        - name: "sys-gitea"
          orgId: 1
          folder: "System"
          type: file
          disableDeletion: true
          editable: false
          options:
            path: /var/lib/grafana/dashboards/sys-gitea
  dashboards:
    app-gitea:
      immich:
        url: https://gitea.alexlebens.dev/alexlebens/grafana-dashboards/raw/branch/main/dashboards/application/immich.json
      radarr:
        url: https://gitea.alexlebens.dev/alexlebens/grafana-dashboards/raw/branch/main/dashboards/application/radarr.json
      sonarr:
        url: https://gitea.alexlebens.dev/alexlebens/grafana-dashboards/raw/branch/main/dashboards/application/sonarr.json
    srv-gitea:
      alertmanager:
        url: https://gitea.alexlebens.dev/alexlebens/grafana-dashboards/raw/branch/main/dashboards/service/alertmanager.json
      argocd:
        url: https://gitea.alexlebens.dev/alexlebens/grafana-dashboards/raw/branch/main/dashboards/service/argocd.json
      authentik:
        url: https://gitea.alexlebens.dev/alexlebens/grafana-dashboards/raw/branch/main/dashboards/service/authentik.json
      blocky:
        url: https://gitea.alexlebens.dev/alexlebens/grafana-dashboards/raw/branch/main/dashboards/service/blocky.json
      cert-manager:
        url: https://gitea.alexlebens.dev/alexlebens/grafana-dashboards/raw/branch/main/dashboards/service/cert-manager.json
      cloudnativepg:
        url: https://gitea.alexlebens.dev/alexlebens/grafana-dashboards/raw/branch/main/dashboards/service/cloudnativepg.json
      coredns:
        url: https://gitea.alexlebens.dev/alexlebens/grafana-dashboards/raw/branch/main/dashboards/service/coredns.json
      descheduler:
        url: https://gitea.alexlebens.dev/alexlebens/grafana-dashboards/raw/branch/main/dashboards/service/descheduler.json
      minio:
        url: https://gitea.alexlebens.dev/alexlebens/grafana-dashboards/raw/branch/main/dashboards/service/minio.json
      speedtest-exporter:
        url: https://gitea.alexlebens.dev/alexlebens/grafana-dashboards/raw/branch/main/dashboards/service/speedtest-exporter.json
      spegel:
        url: https://gitea.alexlebens.dev/alexlebens/grafana-dashboards/raw/branch/main/dashboards/service/spegel.json
      traefik:
        url: https://gitea.alexlebens.dev/alexlebens/grafana-dashboards/raw/branch/main/dashboards/service/traefik.json
      trivy:
        url: https://gitea.alexlebens.dev/alexlebens/grafana-dashboards/raw/branch/main/dashboards/service/trivy.json
      unpoller:
        url: https://gitea.alexlebens.dev/alexlebens/grafana-dashboards/raw/branch/main/dashboards/service/unpoller.json
      vault:
        url: https://gitea.alexlebens.dev/alexlebens/grafana-dashboards/raw/branch/main/dashboards/service/vault.json
      volsync:
        url: https://gitea.alexlebens.dev/alexlebens/grafana-dashboards/raw/branch/main/dashboards/service/volsync.json
    sys-gitea:
      ceph:
        url: https://gitea.alexlebens.dev/alexlebens/grafana-dashboards/raw/branch/main/dashboards/system/ceph.json
      etcd:
        url: https://gitea.alexlebens.dev/alexlebens/grafana-dashboards/raw/branch/main/dashboards/system/etcd.json
      loki:
        url: https://gitea.alexlebens.dev/alexlebens/grafana-dashboards/raw/branch/main/dashboards/system/loki.json
      node-full:
        url: https://gitea.alexlebens.dev/alexlebens/grafana-dashboards/raw/branch/main/dashboards/system/node-full.json
      node-short:
        url: https://gitea.alexlebens.dev/alexlebens/grafana-dashboards/raw/branch/main/dashboards/system/node-short.json
  grafana.ini:
    analytics:
      check_for_updates: false
    server:
      domain: alexlebens.net
      root_url: https://grafana-cl01tl.boreal-beaufort.ts.net
    users:
      auto_assign_org: true
      auto_assign_org_id: 1
    auth:
      disable_login_form: true
      oauth_auto_login: true
      signout_redirect_url: https://auth-cl01tl.boreal-beaufort.ts.net/application/o/grafana/end-session/
    auth.generic_oauth:
      enabled: true
      name: Authentik
      allow_sign_up: true
      scopes: openid profile email
      auth_url: https://auth-cl01tl.boreal-beaufort.ts.net/application/o/authorize/
      token_url: https://auth-cl01tl.boreal-beaufort.ts.net/application/o/token/
      api_url: https://auth-cl01tl.boreal-beaufort.ts.net/application/o/userinfo/
      role_attribute_path: contains(groups, 'Grafana Admins') && 'Admin' || contains(groups, 'Grafana Editors') && 'Editor' || 'Viewer'
