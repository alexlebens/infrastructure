---
# Source: unpackerr/templates/persistent-volume.yaml
apiVersion: v1
kind: PersistentVolume
metadata:
  name: unpackerr-nfs-storage
  namespace: unpackerr
  labels:
    app.kubernetes.io/name: unpackerr-nfs-storage
    app.kubernetes.io/instance: unpackerr
    app.kubernetes.io/part-of: unpackerr
spec:
  persistentVolumeReclaimPolicy: Retain
  storageClassName: nfs-client
  capacity:
    storage: 1Gi
  accessModes:
    - ReadWriteMany
  nfs:
    path: /volume2/Storage
    server: synologybond.alexlebens.net
  mountOptions:
    - vers=4
    - minorversion=1
    - noac
---
# Source: unpackerr/templates/persistent-volume-claim.yaml
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: unpackerr-nfs-storage
  namespace: unpackerr
  labels:
    app.kubernetes.io/name: unpackerr-nfs-storage
    app.kubernetes.io/instance: unpackerr
    app.kubernetes.io/part-of: unpackerr
spec:
  volumeName: unpackerr-nfs-storage
  storageClassName: nfs-client
  accessModes:
    - ReadWriteMany
  resources:
    requests:
      storage: 1Gi
---
# Source: unpackerr/charts/unpackerr/templates/common.yaml
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: unpackerr
  labels:
    app.kubernetes.io/controller: main
    app.kubernetes.io/instance: unpackerr
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: unpackerr
    helm.sh/chart: unpackerr-4.4.0
  namespace: unpackerr
spec:
  revisionHistoryLimit: 3
  replicas: 1
  strategy:
    type: Recreate
  selector:
    matchLabels:
      app.kubernetes.io/controller: main
      app.kubernetes.io/name: unpackerr
      app.kubernetes.io/instance: unpackerr
  template:
    metadata:
      labels: 
        app.kubernetes.io/controller: main
        app.kubernetes.io/instance: unpackerr
        app.kubernetes.io/name: unpackerr
    spec: 
      enableServiceLinks: false
      serviceAccountName: default
      automountServiceAccountToken: true
      hostIPC: false
      hostNetwork: false
      hostPID: false
      dnsPolicy: ClusterFirst
      containers: 
        - env:
          - name: TZ
            value: US/Central
          - name: UN_WEBSERVER_METRICS
            value: "true"
          - name: UN_SONARR_0_URL
            value: http://sonarr.sonarr:80
          - name: UN_SONARR_0_PATHS_0
            value: /mnt/store/Torrent/FINISHED/COMPLETED
          - name: UN_SONARR_1_URL
            value: http://sonarr-4k.sonarr-4k:80
          - name: UN_SONARR_1_PATHS_0
            value: /mnt/store/Torrent/FINISHED/COMPLETED
          - name: UN_SONARR_2_URL
            value: http://sonarr-anime.sonarr-anime:80
          - name: UN_SONARR_2_PATHS_0
            value: /mnt/store/Torrent/FINISHED/COMPLETED
          - name: UN_RADARR_0_URL
            value: http://radarr.radarr:80
          - name: UN_RADARR_0_PATHS_0
            value: /mnt/store/Torrent/FINISHED/COMPLETED
          - name: UN_RADARR_1_URL
            value: http://radarr-4k.radarr-4k:80
          - name: UN_RADARR_1_PATHS_0
            value: /mnt/store/Torrent/FINISHED/COMPLETED
          - name: UN_RADARR_2_URL
            value: http://radarr-anime.radarr-anime:80
          - name: UN_RADARR_2_PATHS_0
            value: /mnt/store/Torrent/FINISHED/COMPLETED
          - name: UN_RADARR_3_URL
            value: http://radarr-standup.radarr-standup:80
          - name: UN_RADARR_3_PATHS_0
            value: /mnt/store/Torrent/FINISHED/COMPLETED
          - name: UN_LIDARR_0_URL
            value: http://lidarr.lidarr:80
          - name: UN_LIDARR_0_PATHS_0
            value: /mnt/store/Torrent/FINISHED/COMPLETED
          envFrom:
          - secretRef:
              name: unpackerr-key-secret
          image: golift/unpackerr:0.14.5
          imagePullPolicy: IfNotPresent
          name: main
          resources:
            requests:
              cpu: 10m
              memory: 128Mi
          volumeMounts:
          - mountPath: /mnt/store
            name: storage
      volumes: 
        - name: storage
          persistentVolumeClaim:
            claimName: unpackerr-nfs-storage
---
# Source: unpackerr/templates/external-secret.yaml
apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: unpackerr-key-secret
  namespace: unpackerr
  labels:
    app.kubernetes.io/name: unpackerr-key-secret
    app.kubernetes.io/instance: unpackerr
    app.kubernetes.io/part-of: unpackerr
spec:
  secretStoreRef:
    kind: ClusterSecretStore
    name: vault
  data:
    - secretKey: UN_SONARR_0_API_KEY
      remoteRef:
        conversionStrategy: Default
        decodingStrategy: None
        key: /cl01tl/sonarr4/key
        metadataPolicy: None
        property: key
    - secretKey: UN_SONARR_1_API_KEY
      remoteRef:
        conversionStrategy: Default
        decodingStrategy: None
        key: /cl01tl/sonarr4-4k/key
        metadataPolicy: None
        property: key
    - secretKey: UN_SONARR_2_API_KEY
      remoteRef:
        conversionStrategy: Default
        decodingStrategy: None
        key: /cl01tl/sonarr4-anime/key
        metadataPolicy: None
        property: key
    - secretKey: UN_RADARR_0_API_KEY
      remoteRef:
        conversionStrategy: Default
        decodingStrategy: None
        key: /cl01tl/radarr5/key
        metadataPolicy: None
        property: key
    - secretKey: UN_RADARR_1_API_KEY
      remoteRef:
        conversionStrategy: Default
        decodingStrategy: None
        key: /cl01tl/radarr5-4k/key
        metadataPolicy: None
        property: key
    - secretKey: UN_RADARR_2_API_KEY
      remoteRef:
        conversionStrategy: Default
        decodingStrategy: None
        key: /cl01tl/radarr5-anime/key
        metadataPolicy: None
        property: key
    - secretKey: UN_RADARR_3_API_KEY
      remoteRef:
        conversionStrategy: Default
        decodingStrategy: None
        key: /cl01tl/radarr5-standup/key
        metadataPolicy: None
        property: key
    - secretKey: UN_LIDARR_0_API_KEY
      remoteRef:
        conversionStrategy: Default
        decodingStrategy: None
        key: /cl01tl/lidarr2/key
        metadataPolicy: None
        property: key
